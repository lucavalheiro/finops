(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[78426],{78426:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return e8}});var r,o=t(47842),i=t(70865),a=t(87394),d=t(52322),l=t(2784),u=t(12524),c=t.n(u),s=t(97729),f=t.n(s),m=t(87093),v=t(938),g=t(18745),p=t(93316),h=t(66351),w=t(88744),_=t(35011),E=t(79758),y=t.n(E),I=function(e){var n=e.width,t=e.message,r=e.backgroundImageUrl,o=e.shareUrl,i=e.showFullScreenButton,a=e.showContinueButton,u=(0,l.useState)(!1),c=u[0],s=u[1],f=(0,l.useState)(!1),m=f[0],v=f[1];(0,l.useEffect)(function(){if(!c){var e=(0,w.Z)(function(){v(window.innerWidth<=n)},300,{leading:!1,trailing:!0});return e(),window.addEventListener("resize",e,!0),function(){window.removeEventListener("resize",e,!0)}}},[n,c]);var g=(0,l.useCallback)(function(){window.open("".concat(o),"_blank")},[o]);return c||!m?null:(0,d.jsxs)("div",{className:y().root,style:{backgroundImage:"url(".concat(r,")")},children:[(0,d.jsx)("h1",{className:y().title,children:void 0===t?"Your screen size looks too small for the demo experience":t}),a&&(0,d.jsx)(_.Z,{variant:"outline",onClick:function(){return s(!0)},children:"I Can Continue"}),i&&(0,d.jsx)(_.Z,{variant:"outline",onClick:g,children:"View Full Screen"})]})},b=t(82214),x=t(5632),C=t(99913),k=t(17627),S=function(e,n){return new URLSearchParams(e).get(n)},j=function(e){var n=window.location,t=(0,l.useState)(function(){return S(n.search,e)}),r=t[0],o=t[1];return(0,l.useEffect)(function(){var t=function(){o(S(n.search,e))};return(0,k.on)(window,"popstate",t),(0,k.on)(window,"pushstate",t),(0,k.on)(window,"replacestate",t),function(){(0,k.S1)(window,"popstate",t),(0,k.S1)(window,"pushstate",t),(0,k.S1)(window,"replacestate",t)}},[n.search,e]),r},R=function(){return null},L=k.jU?j:R,P=t(47467),U=t.n(P),F=t(96670),W=t(61191),T=t(87997),Z=t(61471),q=t(63955),D=t(59911),K=t(57144),A=t(87760),O=t.n(A),N=["first_name","last_name","email","company_name","phone",],Q=function(e){var n=e.onSubmit,t=e.formConfig,r=(0,l.useState)(!1),o=r[0],a=r[1],u=(0,q.cI)({mode:"onChange"}),c=u.register,s=u.handleSubmit,f=u.formState,m=(0,l.useMemo)(function(){return t.fields.reduce(function(e,n){return e[N.findIndex(function(e){return e===n})]=n,e},[])},[t.fields]),v=(0,l.useCallback)(function(e){try{a(!0),n((0,F.Z)((0,i.Z)({},e),{source:Z.M.InternalForm}))}catch(t){a(!1),console.error(t)}},[n]);return(0,d.jsxs)("div",{className:O().root,children:[(0,d.jsx)("h1",{className:O().header,children:t.title||"Try our Product Demo"}),(0,d.jsxs)("form",{onSubmit:s(v),className:O().formGrid,"data-testid":"lead-form",children:[m.map(function(e){var n,t,r,o,a;switch(e){case"email":return(0,d.jsx)(K.Z,(0,i.Z)({label:"Work Email",error:null===(n=f.errors.email)||void 0===n?void 0:n.message,type:"email",className:O().emailField,placeholder:"john.doe.work@company.com"},c("email",{required:"Email is required",pattern:{value:D.hH,message:"Invalid email"}})),"email");case"company_name":return(0,d.jsx)(K.Z,(0,i.Z)({label:"Company Name",error:null===(t=f.errors.company_name)||void 0===t?void 0:t.message,className:O().companyField},c("company_name",{required:"Company name is required"})),"company_name");case"first_name":return(0,d.jsx)(K.Z,(0,i.Z)({label:"First Name",error:null===(r=f.errors.first_name)||void 0===r?void 0:r.message,placeholder:"John"},c("first_name",{required:"First Name is required",maxLength:{value:100,message:"First name is too long"}})),"first_name");case"last_name":return(0,d.jsx)(K.Z,(0,i.Z)({label:"Last Name",error:null===(o=f.errors.last_name)||void 0===o?void 0:o.message,placeholder:"Doe"},c("last_name",{required:"Last Name is required",maxLength:{value:100,message:"Last name is too long"}})),"last_name");case"phone":return(0,d.jsx)(K.Z,(0,i.Z)({label:"Mobile",error:null===(a=f.errors.phone)||void 0===a?void 0:a.message,className:O().phoneField},c("phone",{required:"Mobile is required",maxLength:{value:100,message:"Last name is too long"}})),"phone")}}),(0,d.jsx)("button",{className:O().submit,type:"submit",disabled:o||!f.isValid||f.isSubmitting,children:t.cta||"Continue"})]})]})},V=t(11586),M=t.n(V),H=(0,l.createContext)(null),B=function(e){var n=e.state,t=e.queryFlags,r=e.shareUrl,o=e.children,i=e.demoPlayerEventEmitter,a=e.demoId,l=e.service,u=e.hostInfo,c=e.setCrossOriginTextSubstitutions,s=e.demoParentType,f=e.requestHTTPReferer,m=e.shareHTTPReferer,v=e.hubHTTPReferer,g=e.demoSessionId;return(0,d.jsx)(H.Provider,{value:{demoId:a,queryFlags:t,state:n,shareUrl:r,demoPlayerEventEmitter:i,hostInfo:u,service:l,setCrossOriginTextSubstitutions:c,demoParentType:s,requestHTTPReferer:f,demoSessionId:g,shareHTTPReferer:m,hubHTTPReferer:v},children:o})},z=function(){return(0,l.useContext)(H)},G=function(e){var n,t=e.showWatermark,r=e.watermarkLogoHref,o=z(),a=o.state,l=o.service,u=function(e){l.send({type:"LEAD_CREATED",lead:(0,F.Z)((0,i.Z)({},e.lead),{source:Z.M.VendorForm})})},c=function(e){l.send({type:"LEAD_CREATED",lead:e})},s=a.context.leadFormConfig;return(0,d.jsxs)(d.Fragment,{children:["internal"===s.source?(0,d.jsx)(Q,{onSubmit:c,formConfig:s.internal_form}):(0,d.jsx)(W.Z,{projectId:a.context.project.id,onSubmit:u,width:s.internal_form.width,height:s.internal_form.height,backgroundColor:s.internal_form.backgroundColor,urlQuery:void 0}),t&&(0,d.jsx)("div",{className:M().watermark,children:(0,d.jsx)(T.Z,{testId:"lead-form-watermark",href:r})})]})},J=t(82998),Y=t(36260),$=t(11963),X=t(83564),ee=t(81761),en=t(65478),et=t(34135),er=t(8535),eo=t(15103),ei=t(87032),ea=t(68221),ed=t(93122),el=t(97885),eu=t(35946),ec=t(83496),es=t(3355),ef=t(82095),em=t(13004),ev=t(23884),eg=t(24845),ep=t(95434),eh=t(34448),ew=t(10509),e_=t(35138);function eE(e){return{create:function(n){return{name:e,payload:n}},match:function(n){return n.name===e}}}var ey,eI,eb=eE(ew.rK.DemoOpened),ex=eE(ew.rK.DemoFinished),eC=eE(ew.rK.FlowlistItemClick),ek=eE(ew.rK.FlowEnd),eS=eE(ew.rK.ChapterEnd),ej=eE(ew.rK.PageChanged),eR=eE(ew.rK.LeadCaptured),eL=eE(ew.rK.FlowChanged),eP=eE(ew.rK.ChapterStart),eU=eE(ew.rK.WidgetChanged),eF=eE(ew.rK.WidgetCtaClick),eW=eE(ew.rK.WidgetSecondaryClick),eT=eE(ew.rK.OpenedExternalUrl),eZ=eE(ew.rK.CustomCta),eq=function(e){return eE(e)},eD=(r={},(0,o.Z)(r,ew.rK.DemoOpened,eb),(0,o.Z)(r,ew.rK.DemoFinished,ex),(0,o.Z)(r,ew.rK.OpenedExternalUrl,eT),(0,o.Z)(r,ew.rK.LeadCaptured,eR),(0,o.Z)(r,ew.rK.DemoEngaged10,eq(ew.rK.DemoEngaged10)),(0,o.Z)(r,ew.rK.DemoEngaged25,eq(ew.rK.DemoEngaged25)),(0,o.Z)(r,ew.rK.DemoEngaged50,eq(ew.rK.DemoEngaged50)),(0,o.Z)(r,ew.rK.DemoEngaged75,eq(ew.rK.DemoEngaged75)),(0,o.Z)(r,ew.rK.DemoEngaged100,eq(ew.rK.DemoEngaged100)),eI=Object.values(r),function(e){return eI.some(function(n){return n.match(e)})}),eK=t(13421),eA=function(e){var n=e.projectId,t=e.baseUrl,r=e.body,o=(0,eK.Q)(document.cookie).token;return fetch("".concat(t,"shared/projects/").concat(n,"/tracking"),{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(o)}}).catch(function(e){console.error("Analytics network request failed: ".concat(e))})},eO=t(7463),eN=t(47162),eQ=t(97386),eV=t(95957),eM=t(62326),eH=[10,25,50,75,100];function eB(e,n){n&&globalThis.console.debug("Debug: Engagement Events Tracking:",e)}var ez=function(e){var n=eH.sort(function(e,n){return n-e}),t=e.secondsSpent+1,r=Math.max(e.percentViewed,t),o=n.find(function(e){return r>=e}),i=e.reachedEngagementLevel;return o&&(null===e.reachedEngagementLevel||e.reachedEngagementLevel[0]<o)&&(i=[o,!1]),{secondsSpent:t,reachedEngagementLevel:i}},eG=function(e,n){var t=eH.sort(function(e,n){return n-e}),r=Math.min(100,Math.max(e.percentViewed,n.percentValue)),o=Math.max(r,e.secondsSpent),i=t.find(function(e){return o>=e}),a=e.reachedEngagementLevel;return i&&(null===e.reachedEngagementLevel||e.reachedEngagementLevel[0]<i)&&(a=[i,!1]),{percentViewed:r,reachedEngagementLevel:a}},eJ=(0,eV.C)({id:"demoEngagementEventsTracking",initial:"initial",context:{percentViewed:0,secondsSpent:0,reachedEngagementLevel:null,enabled:!0,targetDocument:null,debug:!1},states:{initial:{always:[{cond:function(e){return!1===e.enabled},target:"completed"},{target:"waitingForUserActivation",cond:function(e){return!0===e.enabled}},]},waitingForUserActivation:{invoke:{src:function(){return function(e){var n,t;return n=function(){return e({type:"start"})},t=function(){try{var e=window.navigator.userActivation.isActive,t=window.navigator.userActivation.hasBeenActive;if(e||t)return n(),!0;return!1}catch(r){return console.error(r),!0}},(0,eM.Uz)({cb:t,interval:500}),function(){(0,eM.NE)(t)}}}},on:{start:{target:"tracking"},viewProgress:{actions:(0,eQ.f0)({percentViewed:function(e,n){return n.percentValue}})}}},tracking:{invoke:{src:function(e){return function(n){var t,r=!1,o=(0,eo.Z)({root:null,element:window.document.documentElement,threshold:[.1,.2,.3,.4,.5,.6,.7,.8,.9,1],cb:function(n){r=n[0].intersectionRatio>.5,eB("iframe intersection => isVisible: ".concat(r),e.debug)}}),i=function(){var n;r=!(null===(n=e.targetDocument)||void 0===n?void 0:n.hidden),eB("browser tab visibilitychange => isVisible: ".concat(r),e.debug)};null===(t=e.targetDocument)||void 0===t||t.addEventListener("visibilitychange",i);var a=setInterval(function(){r&&n({type:"tick"})},1e3);return function(){var n;clearInterval(a),o(),null===(n=e.targetDocument)||void 0===n||n.removeEventListener("visibilitychange",i)}}}},on:{tick:[{actions:["sendEngagementAnalyticsEvent","logDebug"],cond:function(e){return Math.max(e.percentViewed,e.secondsSpent)>=100},target:"completed"},{actions:[(0,eQ.f0)(function(e){return ez(e)}),"sendEngagementAnalyticsEvent","logDebug",]},],viewProgress:[{actions:["sendEngagementAnalyticsEvent","logDebug"],cond:function(e){return Math.max(e.percentViewed,e.secondsSpent)>=100},target:"completed"},{actions:[(0,eQ.f0)(function(e,n){return eG(e,n)}),"sendEngagementAnalyticsEvent","logDebug",]},]}},completed:{type:"final"}}});function eY(e){var n=e.dispatchEngagementEvent,t=e.enabled,r=e.demoPlayerEventEmitter,o=e.targetDocument,i=e.debug,a=(0,et.k)(eJ,{context:{enabled:t,targetDocument:o,debug:i},actions:{logDebug:(0,eQ.f0)(function(e){return eB(JSON.stringify({percentViewed:e.percentViewed,secondsSpent:e.secondsSpent,reachedEngagementLevel:e.reachedEngagementLevel}),e.debug),{}}),sendEngagementAnalyticsEvent:(0,eQ.f0)(function(e){return null!==e.reachedEngagementLevel&&!1===e.reachedEngagementLevel[1]?(n({secondsSpent:e.secondsSpent,percentViewed:e.percentViewed,level:e.reachedEngagementLevel[0]}),{reachedEngagementLevel:[e.reachedEngagementLevel[0],!0,]}):{}})}}).send;(0,l.useEffect)(function(){if(t){var e=r.on(g.W6.widgetChangeEvent,function(e){a({type:"viewProgress",percentValue:e.progress})}),n=r.on(g.W6.walkthroughFinishedEvent,function(){a({type:"viewProgress",percentValue:100})}),o=r.on(g.W6.pageChangeEvent,function(e){a({type:"viewProgress",percentValue:e.progress})});return function(){e(),o(),n()}}},[r,t,a])}var e$=function(){var e,n,t,r,o,a,d,u,c,s,f,v,p,h=z(),w=h.state,_=h.shareUrl,E=h.demoId,y=h.queryFlags,I=h.service,b=h.demoParentType,x=h.demoSessionId,C=(n=(e={disabled:y.recording,waitUserCookieConsent:null===b&&w.context.project.cookie_consent_required}).disabled,t=e.waitUserCookieConsent,r=(0,et.k)(e_.Rq,{context:{disabled:n,waitUserCookieConsent:t}}),o=(0,l.useMemo)(function(){return function(e){r.send({type:e_.xR.DispatchAnalyticsEvent,fn:e})}},[r]),a=(0,l.useCallback)(function(){r.send(e_.xR.ReceivedUserConsent)},[r]),d=(0,l.useCallback)(function(){r.send(e_.xR.DocumentInViewport)},[r]),{dispatch:o,onCookieConsentReceived:a,onDocumentInViewport:d}),k=C.dispatch,S=C.onCookieConsentReceived,j=C.onDocumentInViewport,R=(c=(u=(0,l.useState)(!1))[0],s=u[1],(0,l.useEffect)(function(){if(!c)try{var e=(0,eo.Z)({root:null,element:window.document.documentElement,threshold:[.1,.2,.3,.4,.5,.6,.7,.8,.9,1],cb:function(n){n[0].intersectionRatio>.5&&(s(!0),e())}});return e}catch(n){s(!0)}},[c]),c);(0,l.useEffect)(function(){R&&j()},[R,j]);var L,P,U,W,T,Z,q,D,K,A,O,N,Q,V,M,H,B,G,J,Y,$,X,ee,en,eE,ey,eI,eK,eQ,eV,eM,eH,eB,ez,eG,eJ,e$,eX,e0,e1,e6,e5,e7,e2,e4,e8,e3,e9,ne,nn,nt,nr,no,ni,na,nd,nl,nu,nc,ns,nf,nm,nv,ng,np,nh,nw,n_,nE,ny,nI,nb,nx=(v=(f=(0,l.useState)(!1))[0],p=f[1],(0,l.useEffect)(function(){var e=function(e){try{var n;(null===(n=e.data)||void 0===n?void 0:n.message)===eg.NX&&p(!0)}catch(t){console.error(t)}};return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}},[]),{userCookieConsentReceived:v}).userCookieConsentReceived;return(0,l.useEffect)(function(){nx&&S()},[S,nx]),T=(L={project:w.context.project,query:y.query,demoId:E,baseUrl:"https://api.storylane.io/api/v1/",dispatchFn:k,service:I,demoSessionId:x}).demoId,Z=L.query,q=L.baseUrl,D=L.project,K=L.dispatchFn,A=L.service,O=L.demoSessionId,N=(0,er.v)(A,function(e){return e.context.lead}),(Q=(0,l.useRef)(N)).current=N,M=(V=z()).hostInfo,H=V.demoPlayerEventEmitter,B=V.requestHTTPReferer,G=V.shareHTTPReferer,J=V.hubHTTPReferer,Y=null!==(W=null!==(U=null===(P=M.current)||void 0===P?void 0:P.referer.current)&&void 0!==U?U:G)&&void 0!==W?W:J,$=(0,eO.Z)({eventAction:eN.Y.StorylaneShareUserId,postMessageAction:eN.L.RequestUser}).eventData,X=(0,l.useRef)(void 0),(0,l.useEffect)(function(){X.current=null==$?void 0:$.user_id},[null==$?void 0:$.user_id]),(0,l.useEffect)(function(){var e=function(e){try{var n,t,r,o,i,a,d;if((null===(n=e.data)||void 0===n?void 0:n.message)===eg.rf&&Boolean(null===(t=e.data)||void 0===t?void 0:t.payload)&&"object"==typeof(null===(r=e.data)||void 0===r?void 0:r.payload))K(function(){return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.LeadCaptured,query:Z,clientTracking:e.data.payload,baseUrl:q,userId:X.current,leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})});else if(Boolean(null===(o=e.data)||void 0===o?void 0:o.tracking)&&(null===(i=e.data)||void 0===i?void 0:i.source)===eg.kf){var l=Boolean(e.data.ref)&&"string"==typeof e.data.ref.referrer?e.data.ref.referrer:null,u=Boolean(e.data.ref)&&"string"==typeof e.data.ref.originalReferrer?e.data.ref.originalReferrer:null,c=(0,eh.Ui)(),s=(0,eh.gP)(T,O);K(function(){return eA({projectId:D.id,baseUrl:q,body:{demo:{fingerprint:(0,eh.EQ)(),permanent_cookie_id:c.id,current_cookie_id:s.id,tracking:e.data.tracking,referer:l,original_referer:u},link_value:T}})})}else Boolean(null===(a=e.data)||void 0===a?void 0:a.lead)&&(null===(d=e.data)||void 0===d?void 0:d.source)===eg.Tl&&K(function(){return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.LeadCaptured,query:Z,clientTracking:e.data.lead,baseUrl:q,userId:X.current,leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})})}catch(f){console.error(f)}};return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}},[K,D,T,Z,M,q,O,B,Y,]),ee=(0,l.useCallback)(function(){return K(function(){var e,n;return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.Interacted,query:Z,hostUrl:null===(e=M.current)||void 0===e?void 0:e.url,urlQuery:null===(n=M.current)||void 0===n?void 0:n.query,baseUrl:q,userId:X.current,leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})})},[K,T,D.id,Z,M,q,O,B,Y,]),(0,ep.r)(ee),(0,l.useEffect)(function(){(0,eh.gP)(T,O).state[ew.QR.Opened]||K(function(){var e,n;return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.Opened,query:Z,hostUrl:null===(e=M.current)||void 0===e?void 0:e.url,urlQuery:null===(n=M.current)||void 0===n?void 0:n.query,baseUrl:q,userId:X.current,leadInfo:Q.current,referer:B,originalReferer:Y,sessionId:O})})},[K,D,T,Z,M,q,B,O,Y,]),en="flv_"+T,ey=null==(eE=null==D?void 0:D.flowlists[0])?void 0:eE.items.map(function(e){return[e.id,!1]}),eI=(0,es.Z)(ey),(0,l.useEffect)(function(){if(Object.keys(eI).length){var e=eu.jj.getItem(en),n=JSON.parse(e||"{}"),t=(0,ec.Z)(Object.keys(n),Object.keys(eI));(!e||t.length>0)&&eu.jj.setItem(en,JSON.stringify(eI))}},[T,eI,en,D]),(0,l.useEffect)(function(){return H.on(g.W6.flowChangeEvent,function(e){var n=e.flowId;return K(function(){var e,t;return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.FlowStarted,targetId:n,query:Z,hostUrl:null===(e=M.current)||void 0===e?void 0:e.url,urlQuery:null===(t=M.current)||void 0===t?void 0:t.query,baseUrl:q,userId:X.current,leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})})})},[H,K,D,T,Z,M,q,O,B,Y,]),(0,l.useEffect)(function(){return H.on(g.W6.walkthroughFinishedEvent,function(){K(function(){var e,n;return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.Closed,query:Z,hostUrl:null===(e=M.current)||void 0===e?void 0:e.url,urlQuery:null===(n=M.current)||void 0===n?void 0:n.query,baseUrl:q,userId:X.current,leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})})})},[H,T,K,D.id,D.company_id,Z,M,q,O,B,Y,]),(0,l.useEffect)(function(){return H.on(g.W6.widgetChangeEvent,function(e){var n=e.widgetId;return K(function(){var e,t;return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.WidgetViewed,targetId:n,query:Z,hostUrl:null===(e=M.current)||void 0===e?void 0:e.url,urlQuery:null===(t=M.current)||void 0===t?void 0:t.query,baseUrl:q,userId:X.current,leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})})})},[H,K,D,T,Z,M,q,O,B,Y,]),(0,l.useEffect)(function(){return H.on(g.W6.flowlistItemClickEvent,function(e){var n=e.itemId,t=eu.jj.getItem(en);if(t){var r=JSON.parse(t);r[n]=!0,eu.jj.setItem(en,JSON.stringify(r)),Object.values(r).every(function(e){return e})&&eE&&K(function(){var e,n;return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.FlowlistCompleted,targetId:eE.id,query:Z,hostUrl:null===(e=M.current)||void 0===e?void 0:e.url,urlQuery:null===(n=M.current)||void 0===n?void 0:n.query,baseUrl:q,userId:X.current,leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})})}})},[H,K,D,T,Z,M,q,eE,en,O,B,Y,]),(0,l.useEffect)(function(){return H.on(g.W6.lastWidgetEnterEvent,function(e){var n=e.flowId;K(function(){var e,t;return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.FlowEnded,targetId:n,query:Z,hostUrl:null===(e=M.current)||void 0===e?void 0:e.url,urlQuery:null===(t=M.current)||void 0===t?void 0:t.query,baseUrl:q,userId:X.current,leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})})})},[K,H,D,T,Z,M,q,O,B,Y,]),(0,l.useEffect)(function(){if(D.kind!==m.lI.Image)return H.on(g.W6.pageChangeEvent,function(e){K(function(){var n,t;return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.PageViewed,targetId:e.pageId,query:Z,hostUrl:null===(n=M.current)||void 0===n?void 0:n.url,urlQuery:null===(t=M.current)||void 0===t?void 0:t.query,baseUrl:q,userId:X.current,leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})})})},[K,H,D,T,Z,M,q,O,B,Y,]),(0,l.useEffect)(function(){var e=function(e,n){if(e.isKnownLead&&!(null==n?void 0:n.isKnownLead)&&e.lead){var t=(0,i.Z)({},e.lead);K(function(){return(0,e_.gR)({projectId:D.id,baseUrl:q,demoId:T,event:ew.QR.LeadCaptured,leadCapturedInfo:(0,i.Z)({external_user_id:t.externalId,email:t.email},(0,ef.Z)(t,["externalId","email"])),leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})})}};return A.onChange(e),function(){A.off(e)}},[A,K,D.id,T,q,H,O,B,Y,]),eK=(0,l.useCallback)(function(e,n){K(function(){var t,r;return(0,e_.gR)({demoId:T,projectId:D.id,event:ew.QR.CtaOpened,targetId:n,extUrl:e,query:Z,hostUrl:null===(t=M.current)||void 0===t?void 0:t.url,urlQuery:null===(r=M.current)||void 0===r?void 0:r.query,baseUrl:q,userId:X.current,leadInfo:Q.current,sessionId:O,referer:B,originalReferer:Y})})},[K,D,T,Z,M,q,O,B,Y,]),(0,l.useEffect)(function(){return H.on(g.W6.flowlistItemOpenExternalUrlEvent,function(e){var n,t=e.data,r=e.itemId,o=(0,ev.L)((0,F.Z)((0,i.Z)({},t),{additionalQuery:null===(n=M.current)||void 0===n?void 0:n.query}));o&&eK(o.url,r)})},[H,M,eK]),(0,l.useEffect)(function(){return H.on(g.W6.widgetOpenExternalUrlEvent,function(e){var n,t=e.data,r=e.widgetId,o=(0,ev.L)((0,F.Z)((0,i.Z)({},t),{additionalQuery:null===(n=M.current)||void 0===n?void 0:n.query}));o&&eK(o.url,r)})},[H,M,eK]),(0,l.useEffect)(function(){return H.on(g.W6.customCtaClickEvent,function(e){var n,t=e.data,r=e.projectId,o=(0,ev.L)((0,F.Z)((0,i.Z)({},t),{additionalQuery:null===(n=M.current)||void 0===n?void 0:n.query}));o&&eK(o.url,r)})},[H,eK,M]),eM=(eQ={enabled:!0,gaEnabled:Boolean(w.context.project.ga_measurement_id),gtmEnabled:Boolean(w.context.project.gtm_container_id),project:w.context.project,flows:w.context.flows,widgets:w.context.widgets,shareUrl:_,baseUrl:"https://api.storylane.io/api/v1/",demoId:E,query:y.query,service:I,demoParentType:b,dispatchFn:k}).enabled,eH=eQ.gaEnabled,eB=eQ.gtmEnabled,ez=eQ.demoId,eG=eQ.project,eJ=eQ.flows,e$=eQ.widgets,eX=eQ.shareUrl,e0=eQ.service,e1=eQ.demoParentType,e6=eQ.dispatchFn,e7=(e5=z()).hostInfo,e2=e5.demoPlayerEventEmitter,e4=e5.requestHTTPReferer,e8=e5.queryFlags,e3=(null==eG?void 0:eG.name)||"",e9=null!=e4?e4:"",ne=(0,l.useCallback)(function(){var e;return null!==(eV=null===(e=e7.current)||void 0===e?void 0:e.url)&&void 0!==eV?eV:""},[e7]),nn=eG.ga_lite_enabled?ew.Vp.Lite:ew.Vp.Full,nh=null===(np=(ng={demoParentType:e1}).demoParentType),n_=(nw=(0,l.useState)(void 0))[0],nE=nw[1],nI=(ny=(0,l.useState)("hub"===np||"share"===np))[0],nb=ny[1],nr=(nt=((0,l.useEffect)(function(){if(nh){var e=setTimeout(function(){nb(!0)},5e3),n=function(n){var t;if((null===(t=n.data)||void 0===t?void 0:t.source)===eg.WZ){var r,o,i=null===(r=n.data)||void 0===r?void 0:null===(o=r.host)||void 0===o?void 0:o.gaClientId;i&&(nE(i),nb(!0),clearTimeout(e))}};return window.addEventListener("message",n),function(){window.removeEventListener("message",n),clearTimeout(e)}}},[nh]),{clientId:n_,shouldInitGAandGTM:nI})).shouldInitGAandGTM,no=nt.clientId,ni=(0,et.k)(e_.EI),nu=(nl={queueEvent:na=(0,l.useCallback)(function(e){ni.send({type:e_.qO.QueueEvent,fn:e})},[ni]),onInitialized:nd=(0,l.useCallback)(function(e,n,t){ni.send({type:e_.qO.Initialized,gaMeasurementId:e,gtmContainerId:n,clientId:t})},[ni])}).queueEvent,nc=nl.onInitialized,ns=(0,l.useMemo)(function(){return function(e){eM&&!(nn===ew.Vp.Lite&&!eD(e))&&(eH&&nu(function(){return e6(function(){var n;"function"==typeof window.gtag&&window.gtag("event",e.name,e.payload)})}),eB&&nu(function(){return e6(function(){var n,t;"function"==typeof(null===(t=window.dataLayer)||void 0===t?void 0:t.push)&&window.dataLayer.push((0,i.Z)({event:e.name},e.payload))})}))}},[eM,nu,e6,nn,eH,eB,]),eY({dispatchEngagementEvent:(0,l.useCallback)(function(e){var n,t,r=ew.G2.get(e.level);r&&ns(eq(r).create({demo_id:ez,demo_name:e3,demo_url:eX,seconds_spent:e.secondsSpent,percent_viewed:e.percentViewed,referrer:e9,host_url:null!==(t=null===(n=e7.current)||void 0===n?void 0:n.url)&&void 0!==t?t:""}))},[ns,ez,e3,eX,e9,e7,]),demoPlayerEventEmitter:e2,enabled:eM,targetDocument:globalThis.document,debug:e8.debug}),(0,l.useEffect)(function(){var e=eG.gtm_container_id&&eB,n=eG.ga_measurement_id&&eH;nr&&(e||n)&&nc(n?eG.ga_measurement_id:null,e?eG.gtm_container_id:null,null!=no?no:null)},[nr,nc,eG.ga_measurement_id,eG.gtm_container_id,eB,eH,no,]),(0,l.useEffect)(function(){ns(eb.create({demo_id:ez,demo_name:e3,demo_url:eX,referrer:e9,host_url:ne()}))},[ez,e3,eX,ns,e9,ne,]),(0,l.useEffect)(function(){if(eG.kind!==m.lI.Image)return e2.on(g.W6.pageChangeEvent,function(e){var n=null==eG?void 0:eG.pages.find(function(n){return n.id===e.pageId});if(!n){console.error("Unable to find page by id: ".concat(e.pageId));return}ns(ej.create({demo_id:ez,demo_name:e3,demo_url:eX,page_id:n.id,page_name:n.name,referrer:e9,host_url:ne()}))})},[ns,eX,e3,e2,eG,ez,e9,ne,]),(0,l.useEffect)(function(){return e2.on(g.W6.widgetChangeEvent,function(e){var n=e.widgetId,t=null==e$?void 0:e$[n],r=t?null==eJ?void 0:eJ[t.flowId]:null;if(t&&r){var o=r.widgets.findIndex(function(e){return e===n});ns(eU.create({demo_id:ez,demo_name:e3,demo_url:eX,flow_id:r.id,flow_name:r.name,chapter_id:r.id,chapter_name:r.name,step_id:t.id,step_index:o,referrer:e9,host_url:ne()}))}})},[e$,eJ,ez,eX,e3,ns,e2,e9,ne,]),(0,l.useEffect)(function(){return e2.on(g.W6.widgetCtaClickEvent,function(e){var n=e.widgetId,t=null==e$?void 0:e$[n],r=t?null==eJ?void 0:eJ[t.flowId]:null;if(t&&r){var o=r.widgets.findIndex(function(e){return e===n});ns(eF.create({demo_id:ez,demo_name:e3,demo_url:eX,flow_id:r.id,flow_name:r.name,chapter_id:r.id,chapter_name:r.name,step_id:t.id,step_index:o,referrer:e9,host_url:ne()}))}})},[e2,e$,eJ,ez,eX,e3,ns,e9,ne,]),(0,l.useEffect)(function(){return e2.on(g.W6.widgetSecondaryClickEvent,function(e){var n=e.widgetId,t=null==e$?void 0:e$[n],r=t?null==eJ?void 0:eJ[t.flowId]:null;if(t&&r){var o=r.widgets.findIndex(function(e){return e===n});ns(eW.create({demo_id:ez,demo_name:e3,demo_url:eX,flow_id:r.id,flow_name:r.name,chapter_id:r.id,chapter_name:r.name,step_id:t.id,step_index:o,referrer:e9,host_url:ne()}))}})},[e2,e$,eJ,ez,eX,e3,ns,e9,ne,]),(0,l.useEffect)(function(){return e2.on(g.W6.flowChangeEvent,function(e){var n=e.flowId,t=null==eJ?void 0:eJ[n];t&&(ns(eL.create({demo_id:ez,demo_name:e3,demo_url:eX,flow_id:t.id,flow_name:t.name,referrer:e9,host_url:ne()})),ns(eP.create({demo_id:ez,demo_name:e3,demo_url:eX,chapter_id:t.id,chapter_name:t.name,referrer:e9,host_url:ne()})))})},[e$,eJ,ez,eX,e3,e2,ns,e9,ne,]),(0,l.useEffect)(function(){return e2.on(g.W6.lastWidgetEnterEvent,function(e){var n=e.flowId,t=null==eJ?void 0:eJ[n];t&&(ns(ek.create({demo_id:ez,demo_name:e3,demo_url:eX,flow_id:t.id,flow_name:t.name,referrer:e9,host_url:ne()})),ns(eS.create({demo_id:ez,demo_name:e3,demo_url:eX,chapter_id:t.id,chapter_name:t.name,referrer:e9,host_url:ne()})))})},[e$,eJ,ez,eX,e3,e2,ns,e9,ne,]),nf=(0,l.useCallback)(function(e,n){if(n){var t,r,o,i=null==e$?void 0:e$[n],a=i?null==eJ?void 0:eJ[i.flowId]:null;i&&a&&(t=a.widgets.findIndex(function(e){return e===n})),o=null==a?void 0:a.name,r=null==a?void 0:a.id}ns(eT.create({demo_id:ez,demo_name:e3,demo_url:eX,step_id:n,step_index:t,flow_id:r,flow_name:o,chapter_id:r,chapter_name:o,ext_url:(null==e?void 0:e.url)||"",ext_url_target:e.target,referrer:e9,host_url:ne()}))},[ez,e3,eX,eJ,e$,ns,e9,ne,]),(0,l.useEffect)(function(){return e2.on(g.W6.flowlistItemOpenExternalUrlEvent,function(e){var n,t=e.data,r=(0,ev.L)((0,F.Z)((0,i.Z)({},t),{additionalQuery:null===(n=e7.current)||void 0===n?void 0:n.query}));r&&nf(r)})},[e2,e7,nf]),(0,l.useEffect)(function(){return e2.on(g.W6.widgetOpenExternalUrlEvent,function(e){var n,t=e.data,r=e.widgetId,o=(0,ev.L)((0,F.Z)((0,i.Z)({},t),{additionalQuery:null===(n=e7.current)||void 0===n?void 0:n.query}));o&&nf(o,r)})},[e2,e7,nf]),nm=(0,l.useCallback)(function(e,n){if(n){var t,r,o,i=null==e$?void 0:e$[n],a=i?null==eJ?void 0:eJ[i.flowId]:null;i&&a&&(t=a.widgets.findIndex(function(e){return e===n})),o=null==a?void 0:a.name,r=null==a?void 0:a.id}ns(eZ.create({demo_id:ez,demo_name:e3,demo_url:eX,step_id:n,step_index:t,flow_id:r,flow_name:o,chapter_id:r,chapter_name:o,ext_url:(null==e?void 0:e.url)||"",ext_url_target:e.target,referrer:e9,host_url:ne()}))},[ez,e3,eX,eJ,e$,ns,e9,ne,]),(0,l.useEffect)(function(){return e2.on(g.W6.customCtaClickEvent,function(e){var n=e.data,t=e.widgetId;try{var r,o=(0,ev.L)((0,F.Z)((0,i.Z)({},n),{additionalQuery:null===(r=e7.current)||void 0===r?void 0:r.query}));if(!o)return;nm(o,t),nf(o,t)}catch(a){(0,em.Tb)(a)}})},[e2,nm,nf,e7,]),(0,l.useEffect)(function(){var e=function(e,n){if(e.isKnownLead&&!(null==n?void 0:n.isKnownLead)&&e.lead){var t=(0,i.Z)({},e.lead);ns(eR.create((0,i.Z)({demo_id:ez,demo_name:e3,demo_url:eX,referrer:e9,host_url:ne()},function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_";try{return(0,ei.Z)(n,function(n,o,i){var a=t?"".concat(t).concat(r).concat(i):i;return(0,ed.Z)(o)&&!(0,el.Z)(o)?(0,ea.Z)(n,e(o,a,r)):("string"==typeof o||"number"==typeof o||"boolean"==typeof o)&&(n[a]=o),n},{})}catch(o){return console.error(o),{}}}(t,"","lead"))))}};return e0.onChange(e),function(){e0.off(e)}},[e2,ez,e3,eX,e0,ns,e9,ne,]),(0,l.useEffect)(function(){return e2.on(g.W6.flowlistItemClickEvent,function(e){var n=e.itemId;ns(eC.create({demo_id:ez,demo_name:e3,demo_url:eX,checklist_item_id:n,referrer:e9,host_url:ne()}))})},[e2,e3,eX,ez,ns,e9,ne,]),(0,l.useEffect)(function(){return e2.on(g.W6.walkthroughFinishedEvent,function(){ns(ex.create({demo_id:ez,demo_name:e3,demo_url:eX,referrer:e9,host_url:ne()}))})},[e2,ez,e3,eX,ns,e9,ne,]),null},eX=t(90449),e0=t(26297);function e1(e){var n=e.demoId,t=e.shareUrl,r=e.demoName,o=(0,e0.Z)(e,["demoId","shareUrl","demoName"]),a={event:o.event,demo:{id:n,url:t,name:r},referrer:o.referrer,host_url:o.hostUrl};return(o.event===eg.rc.Engaged10||o.event===eg.rc.Engaged25||o.event===eg.rc.Engaged50||o.event===eg.rc.Engaged75||o.event===eg.rc.Engaged100)&&(a.seconds_spent=o.secondsSpent,a.percent_viewed=o.percentViewed),o.event===eg.rc.LeadCaptured&&o.lead&&(a.lead=o.lead),(o.event===eg.rc.FlowChanged||o.event===eg.rc.WidgetChanged||o.event===eg.rc.FlowEnd||o.event===eg.rc.OpenedExternalUrl||o.event===eg.rc.WidgetCtaClick||o.event===eg.rc.WidgetSecondaryClick||o.event===eg.rc.CustomCta||o.event===eg.rc.StepRendered)&&o.flow&&(a.flow=o.flow,o.event===eg.rc.FlowChanged&&(a.deprecated="This event is deprecated. See: 'chapter_start' event"),o.event===eg.rc.FlowEnd&&(a.deprecated="This event is deprecated. See: 'chapter_end' event"),o.event!==eg.rc.FlowChanged&&o.event!==eg.rc.FlowEnd&&(a.chapter=o.flow)),(o.event===eg.rc.ChapterStart||o.event===eg.rc.ChapterEnd)&&o.chapter&&(a.chapter=o.chapter),(o.event===eg.rc.WidgetChanged||o.event===eg.rc.OpenedExternalUrl||o.event===eg.rc.WidgetCtaClick||o.event===eg.rc.WidgetSecondaryClick||o.event===eg.rc.CustomCta||o.event===eg.rc.StepRendered)&&o.widget&&(a.step=(0,F.Z)((0,i.Z)({},o.widget),{index:o.widget.index+1})),(o.event===eg.rc.PageChanged||o.event===eg.rc.RecordingStart)&&(a.page=o.page),(o.event===eg.rc.OpenedExternalUrl||o.event===eg.rc.CustomCta)&&(a.target={url:o.extUrl,target:o.extUrlTarget,cta_kind:o.ctaKind}),o.event===eg.rc.FlowlistItemClick&&(a.checklist_item={id:o.flowlistItemId}),{message:eg.mr,payload:a}}var e6=function(){var e,n,t,r,o,a,d,u,c,s,f,v,p,h,w,_,E,y,I,b,x,C,k,S,j,R,L,P,U,W,T,Z,q=z(),D=q.state,K=q.shareUrl,A=q.demoId,O=q.demoPlayerEventEmitter,N=q.queryFlags,Q=q.hostInfo,V=q.requestHTTPReferer,M=q.setCrossOriginTextSubstitutions,H=q.demoParentType;return n=(e={project:D.context.project,flows:D.context.flows,widgets:D.context.widgets,demoId:A,query:N.query,enabled:D.matches($.Ae.Playback),baseUrl:"https://api.storylane.io/api/v1/",shareUrl:K,demoPlayerEventEmitter:O,enabledRecordingStartEvent:N.recording,enabledWidgetReadyEvent:N.recording,enabledRecordingStopEvent:N.recording,hostInfo:Q,onReceiveTextSubstitutions:M,httpReferer:V,debug:N.debug}).enabled,t=e.demoId,r=e.project,o=e.flows,a=e.widgets,d=e.query,u=e.baseUrl,c=e.shareUrl,s=e.enabledRecordingStartEvent,f=e.enabledWidgetReadyEvent,v=e.enabledRecordingStopEvent,p=e.onReceiveTextSubstitutions,h=e.demoPlayerEventEmitter,w=e.hostInfo,_=e.httpReferer,E=e.debug,I=(y=(0,l.useState)(!1))[0],b=y[1],x=r.name||"",C=null!=_?_:"",k=(0,l.useCallback)(function(e){var n;return(0,i.Z)({demoId:t,demoName:x,referrer:C,shareUrl:c,hostUrl:(null===(n=w.current)||void 0===n?void 0:n.url)||""},e)},[t,x,C,w,c]),S=(0,l.useCallback)(function(e){window.parent!==window&&window.parent.postMessage(e,"*"),window.postMessage(e,"*")},[]),j=(0,l.useCallback)(function(e){S(e1(k({event:function(e){switch(e){case 10:return eg.rc.Engaged10;case 25:return eg.rc.Engaged25;case 50:return eg.rc.Engaged50;case 75:return eg.rc.Engaged75;case 100:return eg.rc.Engaged100;default:throw Error("Invalid engagement level: ".concat(e))}}(e.level),secondsSpent:e.secondsSpent,percentViewed:e.percentViewed})))},[S,k]),eY({enabled:!0,targetDocument:globalThis.document,dispatchEngagementEvent:j,demoPlayerEventEmitter:h,debug:E}),(0,l.useEffect)(function(){if(E){var e=function(e){console.debug("Incoming message event: ",e)};return globalThis.addEventListener("message",e),function(){globalThis.removeEventListener("message",e)}}},[E]),(0,l.useEffect)(function(){var e=function(e){try{var n,t,r;(null===(n=e.data)||void 0===n?void 0:n.message)===eg.hR&&Boolean(null===(t=e.data)||void 0===t?void 0:t.payload.token)&&"object"==typeof(null===(r=e.data)||void 0===r?void 0:r.payload.token)&&p(e.data.payload.token)}catch(o){console.error(o)}};return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}},[t,d,u,p]),(0,l.useEffect)(function(){var e=window.parent;n&&!I&&(b(!0),e.postMessage({source:eg.IY,ready:!0},"*"))},[n,I]),(0,l.useEffect)(function(){S(e1(k({event:eg.rc.ProjectResolved})))},[S,c,k]),(0,l.useEffect)(function(){if(r.kind!==m.lI.Image)return h.on(g.W6.pageChangeEvent,function(e){var n=e.pageId,t=null==r?void 0:r.pages.find(function(e){return e.id===n});if(!t){console.error("Unable to find page by id: ".concat(n));return}S(e1(k({event:eg.rc.PageChanged,page:{id:t.id,name:t.name}})))})},[h,r.kind,r.pages,S,k,]),(0,l.useEffect)(function(){if(s){var e=function(e){var n=e.pageId,t=null==r?void 0:r.pages.find(function(e){return e.id===n});if(!t){console.error("Unable to find page by id: ".concat(n));return}S(e1(k({event:eg.rc.RecordingStart,page:{id:t.id,name:t.name}})))};return h.on(g.W6.recordingStartReadyEvent,e)}},[S,s,h,r.pages,k,]),(0,l.useEffect)(function(){return h.on(g.W6.widgetChangeEvent,function(e){var n=e.widgetId,t=null==a?void 0:a[n],r=t?null==o?void 0:o[t.flowId]:null;if(t&&r){var i=r.widgets.findIndex(function(e){return e===n});S(e1(k({event:eg.rc.WidgetChanged,flow:{id:r.id,name:r.name},widget:{id:t.id,index:i}})))}})},[S,a,o,k,h,]),(0,l.useEffect)(function(){if(f)return h.on(g.W6.widgetReadyEvent,function(e){var n=e.widgetId,t=null==a?void 0:a[n],r=t?null==o?void 0:o[t.flowId]:null;if(t&&r){var i=r.widgets.findIndex(function(e){return e===n});S(e1(k({event:eg.rc.StepRendered,flow:{id:r.id,name:r.name},widget:{id:t.id,index:i}})))}})},[S,a,f,o,k,h,]),(0,l.useEffect)(function(){return h.on(g.W6.widgetCtaClickEvent,function(e){var n=e.widgetId,t=null==a?void 0:a[n],r=t?null==o?void 0:o[t.flowId]:null;if(t&&r){var i=r.widgets.findIndex(function(e){return e===n});S(e1(k({event:eg.rc.WidgetCtaClick,flow:{id:r.id,name:r.name},widget:{id:t.id,index:i}})))}})},[h,S,a,o,k,]),(0,l.useEffect)(function(){return h.on(g.W6.widgetSecondaryClickEvent,function(e){var n=e.widgetId,t=null==a?void 0:a[n],r=t?null==o?void 0:o[t.flowId]:null;if(t&&r){var i=r.widgets.findIndex(function(e){return e===n});S(e1(k({event:eg.rc.WidgetSecondaryClick,flow:{id:r.id,name:r.name},widget:{id:t.id,index:i}})))}})},[h,S,a,o,k,]),(0,l.useEffect)(function(){return h.on(g.W6.flowChangeEvent,function(e){var n=e.flowId,t=null==o?void 0:o[n];t&&(S(e1(k({event:eg.rc.FlowChanged,flow:{id:t.id,name:t.name}}))),S(e1(k({event:eg.rc.ChapterStart,chapter:{id:t.id,name:t.name}}))))})},[a,o,S,h,k,]),(0,l.useEffect)(function(){return h.on(g.W6.lastWidgetEnterEvent,function(e){var n=e.flowId,t=null==o?void 0:o[n];t&&(S(e1(k({event:eg.rc.FlowEnd,flow:{id:t.id,name:t.name}}))),S(e1(k({event:eg.rc.ChapterEnd,chapter:{id:t.id,name:t.name}}))))})},[a,S,o,h,k,]),R=z().demoParentType,L=(0,l.useCallback)(function(e,n){var t=null,r=null,i=null;if(n){var d=null==a?void 0:a[n],l=d?null==o?void 0:o[d.flowId]:null;d&&l&&(t=l.widgets.findIndex(function(e){return e===n})),i=(null==l?void 0:l.name)||null,r=(null==l?void 0:l.id)||null}var u=null!==t&&n?{id:n,index:t}:void 0,c=null===R?"_blank":e.target;S(e1(k({event:eg.rc.OpenedExternalUrl,widget:u,flow:r&&i?{id:r,name:i}:void 0,extUrl:(null==e?void 0:e.url)||"",extUrlTarget:c,ctaKind:e.ctaKind})))},[k,S,o,a,R]),P=(0,l.useCallback)(function(e,n){var t=null,r=null,i=null;if(n){var d=null==a?void 0:a[n],l=d?null==o?void 0:o[d.flowId]:null;d&&l&&(t=l.widgets.findIndex(function(e){return e===n})),i=(null==l?void 0:l.name)||null,r=(null==l?void 0:l.id)||null}var u=null!==t&&n?{id:n,index:t}:void 0;S(e1(k({event:eg.rc.CustomCta,widget:u,flow:r&&i?{id:r,name:i}:void 0,extUrl:(null==e?void 0:e.url)||"",extUrlTarget:e.target,ctaKind:e.ctaKind})))},[k,S,o,a]),(0,l.useEffect)(function(){var e=[],n=function(e){var n,t=(0,ev.L)({url:e.data.url,target:e.data.target,additionalQuery:null===(n=w.current)||void 0===n?void 0:n.query});t&&L((0,F.Z)((0,i.Z)({},t),{ctaKind:e.data.ctaKind}))};return e.push(h.on(g.W6.flowlistItemOpenExternalUrlEvent,function(e){return n({data:e.data})})),e.push(h.on(g.W6.widgetOpenExternalUrlEvent,n)),e.push(h.on(g.W6.pageLinkOpenExternalUrlEvent,n)),function(){e.forEach(function(e){return e()})}},[h,w,L]),(0,l.useEffect)(function(){return h.on(g.W6.customCtaClickEvent,function(e){var n,t=e.data,r=e.widgetId,o=(0,ev.L)((0,F.Z)((0,i.Z)({},t),{additionalQuery:null===(n=w.current)||void 0===n?void 0:n.query}));o&&(L((0,F.Z)((0,i.Z)({},o),{ctaKind:t.ctaKind}),r),P((0,F.Z)((0,i.Z)({},o),{ctaKind:t.ctaKind}),r))})},[h,P,L,S,w,]),(0,l.useEffect)(function(){return h.on(g.W6.leadCaptureEvent,function(e){S(e1(k({event:eg.rc.LeadCaptured,lead:e.inputLead})))})},[h,S,k]),(0,l.useEffect)(function(){return h.on(g.W6.flowlistItemClickEvent,function(e){var n=e.itemId;S(e1(k({event:eg.rc.FlowlistItemClick,flowlistItemId:n})))})},[h,S,k]),(0,l.useEffect)(function(){return h.on(g.W6.walkthroughFinishedEvent,function(){S(e1(k({event:eg.rc.DemoFinished}))),v&&S(e1(k({event:eg.rc.RecordingStop})))})},[v,t,c,x,h,S,k,]),W=(U={enabled:"share"===H,demoPlayerEventEmitter:O}).enabled,T=U.demoPlayerEventEmitter,Z=(0,l.useRef)({pageId:null,widgetId:null}),(0,l.useEffect)(function(){if(W){var e=T.on(g.W6.pageChangeEvent,function(e){var n=e.pageId;Z.current={pageId:n,widgetId:Z.current.widgetId}}),n=T.on(g.W6.widgetChangeEvent,function(e){var n=e.widgetId;Z.current={pageId:Z.current.pageId,widgetId:n}});return function(){e(),n()}}},[W,T]),(0,l.useEffect)(function(){if(W){var e=function(e){var n,t;if((0,eX.J)(e)&&"presenter-mode-demo-request-state"===e.data.message)try{window.parent.postMessage((t={pageId:Z.current.pageId,widgetId:Z.current.widgetId},(0,eX.g)("presenter-mode-demo-init-response",t)),"*")}catch(r){console.error(r)}};return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}},[W,Z]),null},e5=t(91125),e7=t(98788),e2=t(22970),e4=new g.NV,e8=function(e){var n,t,r,u,s,w,_,E,y,k,S,j,R=e.demoId,P=e.responseData,F=e.baseUrl,W=e.ssParentPageType,T=e.httpReferer,Z=e.demoSessionId,q=(0,x.useRouter)(),D=(0,J.Q)(q.asPath).toString(),K=(0,Y.$t)({search:D}),A=K.recording,O=K.forceHideSteps,N=K.isPresenterModeEnabled,Q=K.scale,V=K.forceStartFlowIndex,M=K.autoPlay,H=K.disableAnimations,z=K.isResponsive,et=K.recordingKind,er=K.debug,eo=K.isChapterMenuDisabled,ei=(0,a.Z)((0,Y.s$)({demoId:R,baseUrl:"https://api.storylane.io/api/v1/",search:D,publishedProject:P,path:q.asPath,demoSessionId:Z}),3),ea=ei[0],ed=ei[1],el=ei[2],eu=(0,Y.zO)({search:D,logHostInfo:Boolean(er)});(0,Y.YP)({demoPageService:el,demoPlayerEventEmitter:e4});var ec,es,ef,em,ev,eg,ep,eh,ew,e_,eE,ey,eI,eb,ex="".concat(F).concat(q.asPath),eC="".concat(ex.replace("/demo/","/share/"));(0,l.useEffect)(function(){return e4.on(g.W6.walkthroughFinishedEvent,function(){ed({type:$.F_.FinishWalkthrough})})},[ed]),(0,Y.HF)({send:ed,demoPlayerEventEmitter:e4}),(0,Y.Ei)({demoPlayerEventEmitter:e4,hostInfo:eu,demoParentType:W}),(0,Y.rc)({projectId:ea.context.project.id,demoPlayerEventEmitter:e4,shareUrl:eC,enabled:A}),es=(ec={enabled:A,demoPlayerEventEmitter:e4,maxFramesNumber:null!==(S=K.recordingSteps)&&void 0!==S?S:en.Dq[et],isLoggingEnabled:Boolean(K.debug),isCaptureFrameEventEnabled:Boolean(et===e5.r.Gif)}).enabled,ef=ec.demoPlayerEventEmitter,em=ec.maxFramesNumber,ev=ec.isCaptureFrameEventEnabled,eg=ec.isLoggingEnabled,ep=(0,l.useCallback)(function(e){try{eg&&console.debug("Debug: Sending `postMessage` to HTML5 service: ",e),window.parent.postMessage(e,"*")}catch(n){}},[eg]),eh=(0,l.useCallback)(function(){ep("start")},[ep]),ew=(0,l.useCallback)(function(){ep("capture_frame")},[ep]),e_=(0,l.useCallback)(function(){ep("end"),eb(!0)},[ep]),eE=(0,l.useRef)(0),eI=(ey=(0,l.useState)(!1))[0],eb=ey[1],(0,l.useEffect)(function(){if(es&&!eI){var e=ef.on(g.W6.recordingStartReadyEvent,function(){eh()}),n=ef.on(g.W6.walkthroughFinishedEvent,function(){e_()}),t=ef.on(g.W6.widgetReadyEvent,(0,e7.Z)(function(){return(0,e2.__generator)(this,function(e){return ev&&ew(),eE.current++,eE.current>=em&&e_(),[2]})}));return function(){e(),n(),t()}}},[es,ef,em,eI,eh,e_,ev,ew,]);var ek=z||Boolean((null===(n=ea.context.project)||void 0===n?void 0:n.kind)===m.lI.Html?null===(t=ea.context.project)||void 0===t?void 0:t.feature_flags.responsive_html_demo_player:null===(r=ea.context.project)||void 0===r?void 0:r.feature_flags.responsive_image_demo_player),eS=null===(u=ea.context.project)||void 0===u?void 0:u.feature_flags.autoscale_vendor_form,ej=(null===(s=ea.context.project)||void 0===s?void 0:s.display_config.min_width_warning)&&!A,eR=null===(w=ea.context.project)||void 0===w?void 0:w.whitelabel,eL="".concat("https://app.storylane.io").concat(h.Z.SignUp,"?utm_source=product&utm_medium=in-app&utm_campaign=made-with-storylane-logo"),eP=(0,l.useState)(function(){return(0,C.ok)()}),eU=eP[0],eF=eP[1],eW=(0,l.useState)(function(){return(0,C.NR)()}),eT=eW[0],eZ=eW[1],eq=(0,l.useCallback)(function(e){(0,C.sE)(e),eF(e)},[]),eD=(null===(_=ea.context.project)||void 0===_?void 0:_.kind)===m.lI.Image&&!H,eK=L("page_id")||(null===(E=ea.context.project)||void 0===E?void 0:E.start_page_id),eA=(0,l.useMemo)(function(){var e;return{isWalkthroughTourDisabled:O,startPageId:eK,isLeadCaptured:Boolean(ea.context.lead),replayButton:eR&&{backgroundColor:eR.replay_demo_bg_color,value:eR.replay_demo_text,color:eR.replay_demo_color},resumeButton:eR&&{backgroundColor:eR.resume_demo_bg_color,value:eR.resume_demo_text,color:eR.resume_demo_color},isWidgetScrollAnimationDisabled:H,isWidgetTranslationAnimationEnabled:Boolean(ea.context.project.translation_animation_enabled),isKeepScrollBetweenWidgets:ea.context.project.feature_flags.keep_demo_scroll_position,isHtmlPreRenderingEnabled:ea.context.project.feature_flags.pre_render_next_page,isRendererHtmlScaleEnabled:Boolean(ea.context.project&&(0,X.w)({displayConfigRendererDimensions:ea.context.project.display_config.renderer_dimensions,startPageDimensions:ea.context.project.pages[0].dimensions,queryFlagScale:Q,projectFlagScale:ea.context.project.display_config.auto_scale})),isVendorLeadFormScaleEnabled:eS,watermarkLogoHref:eL,watermarkTextHref:"".concat("https://app.storylane.io").concat(h.Z.SignUp,"?utm_source=product&utm_medium=in-app&utm_campaign=made-with-storylane-text"),shouldAddWatermark:Boolean(null==eR?void 0:eR.brand_name_enabled),shouldDisplayBrandWatermark:Boolean(null==eR?void 0:eR.product_logo_enabled),isReplayEnabled:null===(j=null===(e=ea.context.project)||void 0===e?void 0:e.display_config.replay)||void 0===j||j,isAudioAutoplayEnabled:eU,setIsAudioAutoplayEnabled:eq,isVideoAutoplayEnabled:eT,setIsVideoAutoplayEnabled:eZ}},[O,eK,ea.context.lead,ea.context.project,eR,H,Q,eS,eL,eU,eq,eT,]),eO=(0,Y.HY)({isWalkthroughSandboxMode:N,isRecording:Boolean(A),isResponsive:ek,disableAnimations:H,forceStartFlowIndex:V,isShadowDomEnabled:Boolean(ea.context.project.feature_flags.shadow_dom_editing),isChapterMenuDisabledSearchParam:eo,queryAutoPlayDelay:M,projectDisplayConfig:ea.context.project.display_config,checkIfHintIsOnTop:ea.context.project.hide_overlay_highlights}),eN=(0,Y.Of)({search:D}),eQ=eN.shareHTTPReferer,eV=eN.hubHTTPReferer,eM=(0,Y.W$)({search:D}),eH=(0,l.useState)({}),eB=eH[0],ez=eH[1],eG=(0,l.useMemo)(function(){var e=ea.context.lead?(0,p.getSubstitutionsFromLead)(ea.context.lead):{},n=ea.context.substitutions.filter(function(e){return e.kind===v.iU.Text}).reduce(function(e,n){var t=n.key,r=n.value;return r&&(e["".concat((0,p.wrapSubstitutionKey)(t))]=r),e},{}),t=Object.keys(eB).reduce(function(e,n){return e["".concat((0,p.wrapSubstitutionKey)(n))]=eB[n],e},{});return(0,i.Z)({},n,eM,t,e)},[ea.context.substitutions,ea.context.lead,eM,eB,]),eJ=(0,l.useMemo)(function(){return ea.context.substitutions.filter(function(e){return e.kind===v.iU.Image}).reduce(function(e,n){return e[n.id]=(0,i.Z)({},n),e},{})},[ea.context.substitutions]);return(0,Y.uG)({demoPlayerEventEmitter:e4,startPageId:eK}),(0,Y.AD)({demoPlayerEventEmitter:e4,shareUrl:eC}),(0,Y.dH)({scripts:ea.context.project.scripts}),(0,d.jsxs)(B,{hostInfo:eu,service:el,demoId:R,queryFlags:K,state:ea,shareUrl:eC,demoPlayerEventEmitter:e4,setCrossOriginTextSubstitutions:ez,demoParentType:W,requestHTTPReferer:T,demoSessionId:Z,shareHTTPReferer:eQ,hubHTTPReferer:eV,children:[(0,d.jsx)(ee.Z,{font:null===(y=ea.context.project)||void 0===y?void 0:y.display_config.font}),(0,d.jsxs)(f(),{children:[(0,b.Z)({isResponsiveDemoPlayerEnabled:ek,htmlClassName:"sl-player-html"}),(null===(k=ea.context.project)||void 0===k?void 0:k.display_config.mobile_viewport)?(0,d.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}):(0,d.jsx)("meta",{name:"viewport",content:"maximum-scale=1.0"})]}),(0,d.jsx)(e$,{}),(0,d.jsx)(e6,{}),(0,d.jsxs)("div",{className:U().root,"data-zoomin":eD,style:{fontFamily:"var(--project-font-family)"},id:en.GN,children:[ea.matches($.Ae.LeadFormShown)&&(0,d.jsx)(G,{showWatermark:ea.context.project.whitelabel.product_logo_enabled,watermarkLogoHref:eL}),(ea.matches($.Ae.Playback)||ea.matches($.Ae.LeadFormShown))&&(0,d.jsx)("div",{className:c()(U()["demo-container"],(0,o.Z)({},U()["demo-container--paused"],ea.matches($.Ae.LeadFormShown))),children:(0,d.jsx)(g.ZP,{project:ea.context.project,projectFlowlist:ea.context.project.flowlists[0]||null,projectFlows:ea.context.flows,textSubstitutions:eG,imageSubstitutions:eJ,projectWidgets:ea.context.widgets,pages:ea.context.project.pages,startPlayback:ea.matches($.Ae.Playback),config:eA,configNew:eO,hostInfo:eu,emitter:e4})}),ea.matches($.Ae.Playback)&&ej&&(0,d.jsx)(I,{width:ea.context.project.display_config.min_width,message:ea.context.project.display_config.min_width_warning_text,backgroundImageUrl:ea.context.project.pages[0].thumbnail_url,targetDomId:en.GN,shareUrl:eC,showFullScreenButton:null===W,showContinueButton:"share"===W||"hub"===W})]})]})}},47162:function(e,n,t){"use strict";var r,o,i,a;t.d(n,{L:function(){return o},Y:function(){return r}}),(i=r||(r={})).StorylaneShareUserId="storylane-share-user-id",(a=o||(o={})).RequestUser="storylane-demo-ready"},7463:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(2784);function o(e){var n=e.eventAction,t=e.postMessageAction,o=(0,r.useState)(null),i=o[0],a=o[1],d=(0,r.useCallback)(function(e){var t;(null===(t=e.data)||void 0===t?void 0:t.action)===n&&a(e.data.payload)},[n]);return(0,r.useEffect)(function(){try{var e,n;t&&(null===(n=window.top)||void 0===n||n.postMessage(t,"*")),null==window||null===(e=window.top)||void 0===e||e.addEventListener("message",d)}catch(r){}return function(){try{var e;null==window||null===(e=window.top)||void 0===e||e.removeEventListener("message",d)}catch(n){}}},[n,d,t]),{eventData:i}}},83564:function(e,n,t){"use strict";function r(e){var n=e.displayConfigRendererDimensions,t=e.startPageDimensions,r=e.queryFlagScale,o=e.projectFlagScale;if(!(null===r?o:r))return!1;var i,a=(i=n||t,i.width>0&&i.height>0);return a||console.warn("Fallback embed dimensions with default values."),a}t.d(n,{w:function(){return r}})},47467:function(e){e.exports={root:"DemoPage_root__3LD9J","zoom-in":"DemoPage_zoom-in__5yJak","demo-container":"DemoPage_demo-container__YAit2","demo-container--paused":"DemoPage_demo-container--paused__sNztW",preloader:"DemoPage_preloader__4xx4E"}},87760:function(e){e.exports={root:"DefaultLeadForm_root__Q_cfn",header:"DefaultLeadForm_header__JlSGh",submit:"DefaultLeadForm_submit___Ot8g",formGrid:"DefaultLeadForm_formGrid__tetQW",emailField:"DefaultLeadForm_emailField___6cNr",phoneField:"DefaultLeadForm_phoneField__pEfQG",companyField:"DefaultLeadForm_companyField__cziuY"}},11586:function(e){e.exports={watermark:"LeadForm_watermark__ikXJQ"}},79758:function(e){e.exports={root:"ScreenSizeWarning_root__VR9lk",title:"ScreenSizeWarning_title__7v_WW",buttonFullScreen:"ScreenSizeWarning_buttonFullScreen__b4WLS"}}}]);